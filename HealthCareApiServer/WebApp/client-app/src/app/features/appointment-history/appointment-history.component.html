<div class="max-w-5xl mx-auto space-y-10">
  <section class="bg-white shadow-sm rounded-3xl p-8 border border-slate-100">
    <h1 class="text-3xl font-bold text-slate-900 mb-2">Appointment history</h1>
    <p class="text-slate-600">
      Review every appointment you have booked with our care team. Details are read-only so you always have a reliable
      record of when and why you were seen.
    </p>
  </section>

  <section *ngIf="errorMessage" class="bg-rose-50 border border-rose-200 text-rose-700 px-4 py-3 rounded-2xl">
    {{ errorMessage }}
  </section>

  <section *ngIf="isLoading" class="flex items-center justify-center">
    <div class="flex items-center space-x-3 text-indigo-600">
      <span class="w-4 h-4 border-2 border-indigo-300 border-t-indigo-600 rounded-full animate-spin"></span>
      <span class="font-medium">Loading your appointmentsâ€¦</span>
    </div>
  </section>

  <ng-container *ngIf="!isLoading && !errorMessage">
    <section class="bg-white rounded-3xl border border-slate-100 shadow-sm p-6 space-y-5">
      <header class="flex items-center justify-between">
        <h2 class="text-2xl font-semibold text-slate-900">Upcoming appointments</h2>
        <span class="text-sm text-slate-500">{{ upcomingAppointments.length }} scheduled</span>
      </header>
      <ng-container *ngIf="upcomingAppointments.length; else noUpcoming">
        <ul class="space-y-4">
          <li *ngFor="let appointment of upcomingAppointments; trackBy: trackByAppointment"
            class="p-5 rounded-2xl border border-slate-200 bg-slate-50">
            <div class="flex flex-col gap-4 sm:flex-row sm:items-start sm:justify-between">
              <div>
                <p class="text-lg font-semibold text-slate-900">{{ appointment.dateTime | date:'EEEE, MMM d, y' }}</p>
                <p class="text-sm text-slate-500">{{ appointment.dateTime | date:'h:mm a' }}</p>
              </div>
              <span class="inline-flex items-center px-3 py-1 text-sm font-medium rounded-full"
                [ngClass]="statusBadgeClasses(appointment.status)">
                {{ appointment.status | enumText: AppointmentStatus }}
              </span>
            </div>
            <dl class="mt-4 grid gap-3 text-sm text-slate-600 sm:grid-cols-2">
              <div>
                <dt class="font-medium text-slate-700">Doctor</dt>
                <dd>{{ appointment.doctorName }}</dd>
              </div>
              <div>
                <dt class="font-medium text-slate-700">Reason</dt>
                <dd>{{ appointment.reason || 'Not specified' }}</dd>
              </div>
            </dl>
            <div *ngIf="appointment.notes" class="mt-4">
              <h3 class="text-sm font-medium text-slate-700">Notes</h3>
              <p class="mt-1 text-sm text-slate-600 whitespace-pre-line">{{ appointment.notes }}</p>
            </div>
          </li>
        </ul>
      </ng-container>
      <ng-template #noUpcoming>
        <p class="text-sm text-slate-500">You do not have any upcoming appointments scheduled.</p>
      </ng-template>
    </section>

    <section class="bg-white rounded-3xl border border-slate-100 shadow-sm p-6 space-y-5">
      <header class="flex items-center justify-between">
        <h2 class="text-2xl font-semibold text-slate-900">Past appointments</h2>
        <span class="text-sm text-slate-500">{{ pastAppointments.length }} recorded</span>
      </header>
      <ng-container *ngIf="pastAppointments.length; else noPast">
        <ul class="space-y-4">
          <li *ngFor="let appointment of pastAppointments; trackBy: trackByAppointment"
            class="p-5 rounded-2xl border border-slate-200">
            <div class="flex flex-col gap-4 sm:flex-row sm:items-start sm:justify-between">
              <div>
                <p class="text-lg font-semibold text-slate-900">{{ appointment.dateTime | date:'EEEE, MMM d, y' }}</p>
                <p class="text-sm text-slate-500">{{ appointment.dateTime | date:'h:mm a' }}</p>
              </div>
              <span class="inline-flex items-center px-3 py-1 text-sm font-medium rounded-full"
                [ngClass]="statusBadgeClasses(appointment.status)">
                {{ appointment.status | enumText: AppointmentStatus }}
              </span>
            </div>
            <dl class="mt-4 grid gap-3 text-sm text-slate-600 sm:grid-cols-2">
              <div>
                <dt class="font-medium text-slate-700">Doctor</dt>
                <dd>{{ appointment.doctorName }}</dd>
              </div>
              <div>
                <dt class="font-medium text-slate-700">Reason</dt>
                <dd>{{ appointment.reason || 'Not specified' }}</dd>
              </div>
            </dl>
            <div class="mt-4">
              <h3 class="text-sm font-medium text-slate-700">Notes</h3>
              <p class="mt-1 text-sm text-slate-600 whitespace-pre-line">
                {{ appointment.notes || 'No notes were added for this visit.' }}
              </p>
            </div>
          </li>
        </ul>
      </ng-container>
      <ng-template #noPast>
        <p class="text-sm text-slate-500">You have not completed any appointments yet.</p>
      </ng-template>
    </section>
  </ng-container>
</div>
